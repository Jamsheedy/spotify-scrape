{
	"name": "Dataflow1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"linkedService": {
						"referenceName": "spotify-scrape-dev-WorkspaceDefaultStorage",
						"type": "LinkedServiceReference"
					},
					"name": "rosters"
				},
				{
					"linkedService": {
						"referenceName": "spotify-scrape-dev-WorkspaceDefaultStorage",
						"type": "LinkedServiceReference"
					},
					"name": "source1"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "rosterColumns"
				},
				{
					"name": "flattenRosterByPlayers"
				}
			],
			"scriptLines": [
				"source(useSchema: false,",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     format: 'json',",
				"     fileSystem: 'raw',",
				"     folderPath: 'sleeper/rosters',",
				"     fileName: 'rosters_992125474790772736_2024-07-17T03:38:12.2167244Z.json',",
				"     documentForm: 'documentPerLine') ~> rosters",
				"source(useSchema: false,",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     format: 'json',",
				"     fileSystem: 'raw',",
				"     folderPath: 'sleeper/players',",
				"     fileName: 'players_992125474790772736_2024-07-17T03:40:50.3694529Z.json',",
				"     documentForm: 'singleDocument') ~> source1",
				"rosters derive(players = flatten(array(byName(\"players\"))),",
				"          roster_starters = flatten(array(byName(\"starters\"))),",
				"          roster_id = toString(byName(\"roster_id\")),",
				"          owner_id = toString(byName(\"owner_id\")),",
				"          league_id = toString(byName(\"league_id\")),",
				"          streak = toString(byItem(byName('metadata'), 'streak')),",
				"          record = toString(byItem(byName('metadata'), 'record')),",
				"          roster_wins = toShort(byItem(byName('settings'), 'wins')),",
				"          waiver_position = toShort(byItem(byName('settings'), 'waiver_position')),",
				"          waiver_budget_used = toShort(byItem(byName('settings'), 'waiver_budget_used')),",
				"          total_moves = toShort(byItem(byName('settings'), 'total_moves')),",
				"          roster_ties = toShort(byItem(byName('settings'), 'ties')),",
				"          roster_ppts_decimal = toShort(byItem(byName('settings'), 'ppts_decimal')),",
				"          roster_ppts = toShort(byItem(byName('settings'), 'ppts')),",
				"          roster_losses = toShort(byItem(byName('settings'), 'losses')),",
				"          fpts_decimal = toShort(byItem(byName('settings'), 'fpts_decimal')),",
				"          fpts_against_decimal = toShort(byItem(byName('settings'), 'fpts_against_decimal')),",
				"          fpts_against = toShort(byItem(byName('settings'), 'fpts_against')),",
				"          fpts = toShort(byItem(byName('settings'), 'fpts'))) ~> rosterColumns",
				"rosterColumns foldDown(unroll(players, players),",
				"     mapColumn(",
				"          players,",
				"          roster_starters,",
				"          roster_id,",
				"          owner_id,",
				"          league_id,",
				"          streak,",
				"          record,",
				"          roster_wins,",
				"          waiver_position,",
				"          waiver_budget_used,",
				"          total_moves,",
				"          roster_ties,",
				"          roster_ppts_decimal,",
				"          roster_ppts,",
				"          roster_losses,",
				"          fpts_decimal,",
				"          fpts_against_decimal,",
				"          fpts_against,",
				"          fpts",
				"     ),",
				"     skipDuplicateMapInputs: false,",
				"     skipDuplicateMapOutputs: false) ~> flattenRosterByPlayers"
			]
		}
	}
}